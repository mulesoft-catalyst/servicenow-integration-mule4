<?xml version='1.0' encoding='UTF-8'?>
<types:mule xmlns:types="http://www.mulesoft.org/schema/mule/types">
  <types:catalog>
    <types:type name="sysID" format="java">
      <types:shape format="raml"><![CDATA[#%RAML 1.0 DataType
type: string]]></types:shape>
    </types:type>
    <types:type name="tasks" format="json">
      <types:shape format="weave" example="examples/tasks.json"><![CDATA[%dw 2.0

type tasks = {|
  result: Array<{|    parent: {|      link: String,       value: String    |},     made_sla: String,     watch_list: String,     sc_catalog: String,     upon_reject: String,     sys_updated_on: String,     approval_history: String,     number: String,     sys_updated_by: String,     opened_by: {|      link: String,       value: String    |},     user_input: String,     sys_created_on: String,     sys_domain: {|      link: String,       value: String    |},     state: String,     sys_created_by: String,     knowledge: String,     order: String,     calendar_stc: String,     closed_at: String,     cmdb_ci: String,     delivery_plan: String,     contract: String,     impact: String,     active: String,     work_notes_list: String,     business_service: String,     priority: String,     sys_domain_path: String,     time_worked: String,     expected_start: String,     opened_at: String,     business_duration: String,     group_list: String,     work_end: String,     approval_set: String,     work_notes: String,     request: {|      link: String,       value: String    |},     short_description: String,     correlation_display: String,     delivery_task: String,     work_start: String,     assignment_group: {|      link: String,       value: String    |},     additional_assignee_list: String,     description: String,     calendar_duration: String,     close_notes: String,     service_offering: String,     sys_class_name: String,     closed_by: String,     follow_up: String,     sys_id: String,     contact_type: String,     urgency: String,     company: String,     reassignment_count: String,     activity_due: String,     assigned_to: String,     comments: String,     approval: String,     sla_due: String,     comments_and_work_notes: String,     due_date: String,     sys_mod_count: String,     request_item: {|      link: String,       value: String    |},     sys_tags: String,     escalation: String,     upon_approval: String,     correlation_id: String,     location: String  |}>
|} {"example": "{\\\"result\\\":[{\\\"parent\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/task\\/42e698e9db7e0010828e112039961940\\\",\\\"value\\\":\\\"42e698e9db7e0010828e112039961940\\\"},\\\"made_sla\\\":\\\"true\\\",\\\"watch_list\\\":\\\"\\\",\\\"sc_catalog\\\":\\\"\\\",\\\"upon_reject\\\":\\\"cancel\\\",\\\"sys_updated_on\\\":\\\"2020-02-05 21:22:09\\\",\\\"approval_history\\\":\\\"\\\",\\\"number\\\":\\\"SCTASK0010004\\\",\\\"sys_updated_by\\\":\\\"admin\\\",\\\"opened_by\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sys_user\\/6816f79cc0a8016401c5a33be04be441\\\",\\\"value\\\":\\\"6816f79cc0a8016401c5a33be04be441\\\"},\\\"user_input\\\":\\\"\\\",\\\"sys_created_on\\\":\\\"2020-02-05 21:22:09\\\",\\\"sys_domain\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sys_user_group\\/global\\\",\\\"value\\\":\\\"global\\\"},\\\"state\\\":\\\"1\\\",\\\"sys_created_by\\\":\\\"admin\\\",\\\"knowledge\\\":\\\"false\\\",\\\"order\\\":\\\"\\\",\\\"calendar_stc\\\":\\\"\\\",\\\"closed_at\\\":\\\"\\\",\\\"cmdb_ci\\\":\\\"\\\",\\\"delivery_plan\\\":\\\"\\\",\\\"contract\\\":\\\"\\\",\\\"impact\\\":\\\"3\\\",\\\"active\\\":\\\"true\\\",\\\"work_notes_list\\\":\\\"\\\",\\\"business_service\\\":\\\"\\\",\\\"priority\\\":\\\"4\\\",\\\"sys_domain_path\\\":\\\"\\/\\\",\\\"time_worked\\\":\\\"\\\",\\\"expected_start\\\":\\\"2020-02-05 21:22:09\\\",\\\"opened_at\\\":\\\"2020-02-05 21:22:09\\\",\\\"business_duration\\\":\\\"\\\",\\\"group_list\\\":\\\"\\\",\\\"work_end\\\":\\\"\\\",\\\"approval_set\\\":\\\"\\\",\\\"work_notes\\\":\\\"\\\",\\\"request\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sc_request\\/0ee698e9db7e0010828e11203996193f\\\",\\\"value\\\":\\\"0ee698e9db7e0010828e11203996193f\\\"},\\\"short_description\\\":\\\"Order from vendor or move from in-stock inventory\\\",\\\"correlation_display\\\":\\\"\\\",\\\"delivery_task\\\":\\\"\\\",\\\"work_start\\\":\\\"\\\",\\\"assignment_group\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sys_user_group\\/8a4cb6d4c61122780043b1642efcd52b\\\",\\\"value\\\":\\\"8a4cb6d4c61122780043b1642efcd52b\\\"},\\\"additional_assignee_list\\\":\\\"\\\",\\\"description\\\":\\\"Order from vendor or move from in-stock inventory\\\",\\\"calendar_duration\\\":\\\"\\\",\\\"close_notes\\\":\\\"\\\",\\\"service_offering\\\":\\\"\\\",\\\"sys_class_name\\\":\\\"sc_task\\\",\\\"closed_by\\\":\\\"\\\",\\\"follow_up\\\":\\\"\\\",\\\"sys_id\\\":\\\"f2e69ce9db7e0010828e112039961951\\\",\\\"contact_type\\\":\\\"\\\",\\\"urgency\\\":\\\"3\\\",\\\"company\\\":\\\"\\\",\\\"reassignment_count\\\":\\\"0\\\",\\\"activity_due\\\":\\\"\\\",\\\"assigned_to\\\":\\\"\\\",\\\"comments\\\":\\\"\\\",\\\"approval\\\":\\\"not requested\\\",\\\"sla_due\\\":\\\"\\\",\\\"comments_and_work_notes\\\":\\\"\\\",\\\"due_date\\\":\\\"2020-02-05 21:22:09\\\",\\\"sys_mod_count\\\":\\\"0\\\",\\\"request_item\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sc_req_item\\/42e698e9db7e0010828e112039961940\\\",\\\"value\\\":\\\"42e698e9db7e0010828e112039961940\\\"},\\\"sys_tags\\\":\\\"\\\",\\\"escalation\\\":\\\"0\\\",\\\"upon_approval\\\":\\\"proceed\\\",\\\"correlation_id\\\":\\\"\\\",\\\"location\\\":\\\"\\\"}]}"}

]]></types:shape>
    </types:type>
    <types:type name="consolidatedMetadata" format="json">
      <types:shape format="weave" example="examples/ConsolidatedRequestData.json"><![CDATA[%dw 2.0

type consolidatedMetadata = {|
  RequestNumber: String, 
  RequestSysID: String, 
  RequestItems: Array<{|    RequestItemNumber: String,     RequestItemSysID: String,     Tasks: Array<{| TaskID: String |}>
  |}>
|} {"example": "{\\\"RequestNumber\\\":\\\"\\\",\\\"RequestSysID\\\":\\\"\\\",\\\"RequestItems\\\":[{\\\"RequestItemNumber\\\":\\\"\\\",\\\"RequestItemSysID\\\":\\\"\\\",\\\"Tasks\\\":[{\\\"TaskID\\\":\\\"\\\"},{\\\"TaskID\\\":\\\"\\\"}]},{\\\"RequestItemNumber\\\":\\\"\\\",\\\"RequestItemSysID\\\":\\\"\\\",\\\"Tasks\\\":[{\\\"TaskID\\\":\\\"\\\"},{\\\"TaskID\\\":\\\"\\\"}]}]}"}

]]></types:shape>
    </types:type>
    <types:type name="requestItem" format="json">
      <types:shape format="weave" example="examples/requestItem.json"><![CDATA[%dw 2.0

type requestItem = {|
  result: Array<{|    parent: String,     made_sla: String,     watch_list: String,     sc_catalog: String,     upon_reject: String,     sys_updated_on: String,     approval_history: String,     number: String,     sys_updated_by: String,     opened_by: {|      link: String,       value: String    |},     user_input: String,     price: String,     sys_created_on: String,     recurring_frequency: String,     sys_domain: {|      link: String,       value: String    |},     context: {|      link: String,       value: String    |},     state: String,     sys_created_by: String,     knowledge: String,     order: String,     closed_at: String,     cmdb_ci: String,     delivery_plan: String,     backordered: String,     contract: String,     impact: String,     active: String,     work_notes_list: String,     business_service: String,     priority: String,     sys_domain_path: String,     time_worked: String,     expected_start: String,     opened_at: String,     business_duration: String,     group_list: String,     configuration_item: String,     work_end: String,     approval_set: String,     work_notes: String,     order_guide: String,     request: {|      link: String,       value: String    |},     short_description: String,     correlation_display: String,     delivery_task: String,     work_start: String,     assignment_group: String,     additional_assignee_list: String,     description: String,     calendar_duration: String,     close_notes: String,     service_offering: String,     sys_class_name: String,     closed_by: String,     follow_up: String,     sys_id: String,     contact_type: String,     urgency: String,     company: String,     reassignment_count: String,     activity_due: String,     assigned_to: String,     comments: String,     quantity: String,     approval: String,     sla_due: String,     comments_and_work_notes: String,     due_date: String,     sys_mod_count: String,     recurring_price: String,     sys_tags: String,     billable: String,     cat_item: {|      link: String,       value: String    |},     stage: String,     escalation: String,     upon_approval: String,     correlation_id: String,     location: String,     estimated_delivery: String  |}>
|} {"example": "{\\\"result\\\":[{\\\"parent\\\":\\\"\\\",\\\"made_sla\\\":\\\"true\\\",\\\"watch_list\\\":\\\"\\\",\\\"sc_catalog\\\":\\\"\\\",\\\"upon_reject\\\":\\\"cancel\\\",\\\"sys_updated_on\\\":\\\"2020-01-30 20:58:46\\\",\\\"approval_history\\\":\\\"\\\",\\\"number\\\":\\\"RITM0000001\\\",\\\"sys_updated_by\\\":\\\"admin\\\",\\\"opened_by\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sys_user\\/6816f79cc0a8016401c5a33be04be441\\\",\\\"value\\\":\\\"6816f79cc0a8016401c5a33be04be441\\\"},\\\"user_input\\\":\\\"\\\",\\\"price\\\":\\\"600\\\",\\\"sys_created_on\\\":\\\"2020-01-30 20:58:44\\\",\\\"recurring_frequency\\\":\\\"\\\",\\\"sys_domain\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sys_user_group\\/global\\\",\\\"value\\\":\\\"global\\\"},\\\"context\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/wf_context\\/4bed669047801200e0ef563dbb9a7128\\\",\\\"value\\\":\\\"4bed669047801200e0ef563dbb9a7128\\\"},\\\"state\\\":\\\"1\\\",\\\"sys_created_by\\\":\\\"admin\\\",\\\"knowledge\\\":\\\"false\\\",\\\"order\\\":\\\"\\\",\\\"closed_at\\\":\\\"\\\",\\\"cmdb_ci\\\":\\\"\\\",\\\"delivery_plan\\\":\\\"\\\",\\\"backordered\\\":\\\"false\\\",\\\"contract\\\":\\\"\\\",\\\"impact\\\":\\\"3\\\",\\\"active\\\":\\\"true\\\",\\\"work_notes_list\\\":\\\"\\\",\\\"business_service\\\":\\\"\\\",\\\"priority\\\":\\\"4\\\",\\\"sys_domain_path\\\":\\\"\\/\\\",\\\"time_worked\\\":\\\"\\\",\\\"expected_start\\\":\\\"\\\",\\\"opened_at\\\":\\\"2020-01-30 20:58:44\\\",\\\"business_duration\\\":\\\"\\\",\\\"group_list\\\":\\\"\\\",\\\"configuration_item\\\":\\\"\\\",\\\"work_end\\\":\\\"\\\",\\\"approval_set\\\":\\\"\\\",\\\"work_notes\\\":\\\"\\\",\\\"order_guide\\\":\\\"\\\",\\\"request\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sc_request\\/6eed229047801200e0ef563dbb9a71c2\\\",\\\"value\\\":\\\"6eed229047801200e0ef563dbb9a71c2\\\"},\\\"short_description\\\":\\\"Apple iPad 3\\\",\\\"correlation_display\\\":\\\"\\\",\\\"delivery_task\\\":\\\"\\\",\\\"work_start\\\":\\\"\\\",\\\"assignment_group\\\":\\\"\\\",\\\"additional_assignee_list\\\":\\\"\\\",\\\"description\\\":\\\"\\\",\\\"calendar_duration\\\":\\\"\\\",\\\"close_notes\\\":\\\"\\\",\\\"service_offering\\\":\\\"\\\",\\\"sys_class_name\\\":\\\"sc_req_item\\\",\\\"closed_by\\\":\\\"\\\",\\\"follow_up\\\":\\\"\\\",\\\"sys_id\\\":\\\"aeed229047801200e0ef563dbb9a71c2\\\",\\\"contact_type\\\":\\\"\\\",\\\"urgency\\\":\\\"3\\\",\\\"company\\\":\\\"\\\",\\\"reassignment_count\\\":\\\"0\\\",\\\"activity_due\\\":\\\"\\\",\\\"assigned_to\\\":\\\"\\\",\\\"comments\\\":\\\"\\\",\\\"quantity\\\":\\\"1\\\",\\\"approval\\\":\\\"approved\\\",\\\"sla_due\\\":\\\"\\\",\\\"comments_and_work_notes\\\":\\\"\\\",\\\"due_date\\\":\\\"2020-02-01 20:58:43\\\",\\\"sys_mod_count\\\":\\\"1\\\",\\\"recurring_price\\\":\\\"0\\\",\\\"sys_tags\\\":\\\"\\\",\\\"billable\\\":\\\"false\\\",\\\"cat_item\\\":{\\\"link\\\":\\\"https:\\/\\/dev65223.service-now.com\\/api\\/now\\/table\\/sc_cat_item\\/060f3afa3731300054b6a3549dbe5d3e\\\",\\\"value\\\":\\\"060f3afa3731300054b6a3549dbe5d3e\\\"},\\\"stage\\\":\\\"fulfillment\\\",\\\"escalation\\\":\\\"0\\\",\\\"upon_approval\\\":\\\"proceed\\\",\\\"correlation_id\\\":\\\"\\\",\\\"location\\\":\\\"\\\",\\\"estimated_delivery\\\":\\\"\\\"}]}"}

]]></types:shape>
    </types:type>
  </types:catalog>
  <types:enrichment select="#e9467988-8232-4a00-a04a-cdb1129da062"/>
  <types:enrichment select="#728d5a68-d56c-4704-ab9e-9b367d285255"/>
  <types:enrichment select="#004109c0-2327-4207-a487-27718b55b061"/>
  <types:enrichment select="#6fa8828f-fc06-41fb-98ad-23a689f6bc3a">
    <types:processor-declaration>
      <types:input-event>
        <types:variables>
          <types:variable name="tasksVar" type="tasks"/>
          <types:variable name="AllRequestItems" type="requestItem"/>
        </types:variables>
      </types:input-event>
      <types:output-event>
        <types:message>
          <types:payload type="consolidatedMetadata"/>
        </types:message>
      </types:output-event>
    </types:processor-declaration>
  </types:enrichment>
</types:mule>